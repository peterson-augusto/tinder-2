{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/peter/OneDrive/\\xC1rea de Trabalho/TRABALHO FT/tinder-0/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/peter/OneDrive/\\xC1rea de Trabalho/TRABALHO FT/tinder-0/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/peter/OneDrive/\\xC1rea de Trabalho/TRABALHO FT/tinder-0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import TinderCard from'react-tinder-card';import{useEffect,useState}from'react';import ChatContainer from'../components/ChatContainer';import{useCookies}from'react-cookie';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Dashboard=function Dashboard(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),genderedUsers=_useState4[0],setGenderedUsers=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),lastDirection=_useState6[0],setLastDirection=_useState6[1];var _useCookies=useCookies(['user']),_useCookies2=_slicedToArray(_useCookies,3),cookies=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var userId=cookies.UserId;var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('http://localhost:8000/user',{params:{userId:userId}});case 3:response=_context.sent;setUser(response.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getUser(){return _ref.apply(this,arguments);};}();var getGenderedUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get('http://localhost:8000/gendered-users',{params:{gender:user===null||user===void 0?void 0:user.gender_interest}});case 3:response=_context2.sent;setGenderedUsers(response.data);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function getGenderedUsers(){return _ref2.apply(this,arguments);};}();useEffect(function(){getUser();getGenderedUsers();},[]);useEffect(function(){if(user){getGenderedUsers();}},[user]);var updateMatches=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(matchedUserId){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put('http://localhost:8000/addmatch',{userId:userId,matchedUserId:matchedUserId});case 3:getUser();_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function updateMatches(_x){return _ref3.apply(this,arguments);};}();var swiped=function swiped(direction,swipedUserId){if(direction==='right'){updateMatches(swipedUserId);}setLastDirection(direction);};var outOfFrame=function outOfFrame(name){console.log(name+' left the screen!');};var matchedUserIds=user===null||user===void 0?void 0:user.matches.map(function(_ref4){var user_id=_ref4.user_id;return user_id;}).concat(userId);var filteredGenderedUsers=genderedUsers===null||genderedUsers===void 0?void 0:genderedUsers.filter(function(genderedUser){return!matchedUserIds.includes(genderedUser.user_id);});console.log('filteredGenderedUsers ',filteredGenderedUsers);return/*#__PURE__*/_jsx(_Fragment,{children:user&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(ChatContainer,{user:user}),/*#__PURE__*/_jsx(\"div\",{className:\"swipe-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-container\",children:[filteredGenderedUsers===null||filteredGenderedUsers===void 0?void 0:filteredGenderedUsers.map(function(genderedUser){return/*#__PURE__*/_jsx(TinderCard,{className:\"swipe\",onSwipe:function onSwipe(dir){return swiped(dir,genderedUser.user_id);},onCardLeftScreen:function onCardLeftScreen(){return outOfFrame(genderedUser.first_name);},children:/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\"+genderedUser.url+\")\"},className:\"card\",children:/*#__PURE__*/_jsx(\"h3\",{children:genderedUser.first_name})})},genderedUser.user_id);}),/*#__PURE__*/_jsx(\"div\",{className:\"swipe-info\",children:lastDirection?/*#__PURE__*/_jsxs(\"p\",{children:[\"You swiped \",lastDirection]}):/*#__PURE__*/_jsx(\"p\",{})})]})})]})});};export default Dashboard;","map":{"version":3,"names":["TinderCard","useEffect","useState","ChatContainer","useCookies","axios","Dashboard","user","setUser","genderedUsers","setGenderedUsers","lastDirection","setLastDirection","cookies","setCookie","removeCookie","userId","UserId","getUser","get","params","response","data","console","log","getGenderedUsers","gender","gender_interest","updateMatches","matchedUserId","put","swiped","direction","swipedUserId","outOfFrame","name","matchedUserIds","matches","map","user_id","concat","filteredGenderedUsers","filter","genderedUser","includes","dir","first_name","backgroundImage","url"],"sources":["C:/Users/peter/OneDrive/Ãrea de Trabalho/TRABALHO FT/tinder-0/client/src/pages/Dashboard.js"],"sourcesContent":["import TinderCard from 'react-tinder-card'\r\nimport { useEffect, useState } from 'react'\r\nimport ChatContainer from '../components/ChatContainer'\r\nimport { useCookies } from 'react-cookie'\r\nimport axios from 'axios'\r\n\r\nconst Dashboard = () => {\r\n    const [user, setUser] = useState(null)\r\n    const [genderedUsers, setGenderedUsers] = useState(null)\r\n    const [lastDirection, setLastDirection] = useState()\r\n    const [cookies, setCookie, removeCookie] = useCookies(['user'])\r\n\r\n    const userId = cookies.UserId\r\n\r\n\r\n    const getUser = async () => {\r\n        try {\r\n            const response = await axios.get('http://localhost:8000/user', {\r\n                params: { userId }\r\n            })\r\n            setUser(response.data)\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n    const getGenderedUsers = async () => {\r\n        try {\r\n            const response = await axios.get('http://localhost:8000/gendered-users', {\r\n                params: { gender: user?.gender_interest }\r\n            })\r\n            setGenderedUsers(response.data)\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        getUser()\r\n        getGenderedUsers()\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            getGenderedUsers()\r\n        }\r\n    }, [user])\r\n\r\n\r\n    const updateMatches = async (matchedUserId) => {\r\n        try {\r\n            await axios.put('http://localhost:8000/addmatch', {\r\n                userId,\r\n                matchedUserId\r\n            })\r\n            getUser()\r\n        } catch (err) {\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n\r\n    const swiped = (direction, swipedUserId) => {\r\n        if (direction === 'right') {\r\n            updateMatches(swipedUserId)\r\n        }\r\n        setLastDirection(direction)\r\n    }\r\n\r\n    const outOfFrame = (name) => {\r\n        console.log(name + ' left the screen!')\r\n    }\r\n\r\n    const matchedUserIds = user?.matches.map(({ user_id }) => user_id).concat(userId)\r\n\r\n    const filteredGenderedUsers = genderedUsers?.filter(genderedUser => !matchedUserIds.includes(genderedUser.user_id))\r\n\r\n\r\n    console.log('filteredGenderedUsers ', filteredGenderedUsers)\r\n    return (\r\n        <>\r\n            {user &&\r\n                <div className=\"dashboard\">\r\n                    <ChatContainer user={user} />\r\n                    <div className=\"swipe-container\">\r\n                        <div className=\"card-container\">\r\n\r\n                            {filteredGenderedUsers?.map((genderedUser) =>\r\n                                <TinderCard\r\n                                    className=\"swipe\"\r\n                                    key={genderedUser.user_id}\r\n                                    onSwipe={(dir) => swiped(dir, genderedUser.user_id)}\r\n                                    onCardLeftScreen={() => outOfFrame(genderedUser.first_name)}>\r\n                                    <div\r\n                                        style={{ backgroundImage: \"url(\" + genderedUser.url + \")\" }}\r\n                                        className=\"card\">\r\n                                        <h3>{genderedUser.first_name}</h3>\r\n                                    </div>\r\n                                </TinderCard>\r\n                            )}\r\n                            <div className=\"swipe-info\">\r\n                                {lastDirection ? <p>You swiped {lastDirection}</p> : <p />}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>}\r\n        </>\r\n    )\r\n}\r\nexport default Dashboard    "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}